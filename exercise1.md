# Веб-приложения MPA, SPA,PWA

**MPA** (*Multi Page Application*)- это многостраничные приложения, которые работают по традиционной схеме. При каждом незначительном изменении данных или загрузке новой информации страница обновляется. Когда вы переходите на новую страницу, ваш браузер запрашивает новую страницу HTML с сервера. Такие приложения тяжелее, чем одностраничные. 

**Недостатки:**  
- Тесная связь между бекендом и фронтендом, что не позволяет развивать их параллельно.
- сложная разработка — требуют использования фреймворков как на стороне клиента, так и на стороне сервера, что увеличивает сроки и бюджет разработки.
- для разработки мобильных приложений потребуется намного больше времени. В большинстве случаев потребуется написание back-end с нуля
- поддерживать и обновлять крупные многостраничные вебсайты хлопотно.
- Ниже скорость взаимодействия. MPA-серверы перезагружают контент, когда пользователь взаимодействует с приложением. Хотя существуют методы ускорения MPA (например, оптимизация работы с кэшем), но пользовательский опыт все же не будет дотягивать до SPA.

**Преимущества:**

- Простая SEO оптимизация — можно оптимизировать каждую из страниц приложения под нужные ключевые запросы.  
- Легкая разработка. Как правило для разработки многостраничного приложения требуется меньший стек технологий.
- Масштабируемость. MPA-архитектура подходит, когда вебсайт состоит из сотен и тысяч страниц.  
- Навигация. Пользователь может сохранять ссылки на страницы в закладках и легко делиться ими.
- Возможность использования готовых решений, таких как OpenCart и WordPress c его плагином WooCommerce.

Использование MPA целесообразно, если приложения используются только для чтения информации или есть необходимость в использовании приложения в браузерах без поддержки JavaScript.

MPA больше подходит для создания крупных интернет магазинов, бизнес сайтов, каталогов, маркетплейсов и т.п  

**Примеры MPA:**  
- <https://aliexpress.com>
- <https://amazon.com>
- <https://ebay.com>

**SPA** (*Single Page Application*) - одностраничное интерактивное приложение. 
Важно, что оно не только находится на одной странице, но и, подобно полноценной программе, является интерактивным.  

Основной язык создания SPA – JavaScript. Небольшое одностраничное приложение можно сделать с помощью библиотеки jQuery. Однако этот вариант не самый оптимальный для больших проектов. Лучше использовать фреймворки Vue, React или Angular.  

**Преимущества одностраничных приложений:**  
- Скорость. Быстродействие достигается благодаря тому, что контент, который не меняется из вкладки во вкладку, не нужно перезагружать.
- Скорость разработки. Основную часть программы составляет фронтенд. Поэтому снижаются затраты на написание серверной части.
- Код SPA можно использовать как основу для разработки мобильных приложений.
- Пользовательский опыт сравним с удобством полноценной программой.
- Кэширование. SPA более эффективно в работе с кэшем.
- Поиск и устранение багов через инструменты разработчика для Хрома.

**Недостатки**  

- SEO. Поскольку информация подгружается в основном по запросу пользователя, кроулеры Google и Яндекс, не всегда могут просканировать (и проиндексировать) части SPA.
- Некоторые пользователи отключают JavaScript на своих браузерах. В таком случае приложение не будет работать.
- Проблемы с безопасностью. SPA более уязвимы для межсайтовых атак (XSS). Хотя масштаб работ по обеспечению безопасности одностраничной программы меньше, чем в многостраничных приложениях.  

**Примеры:**
 - <https://www.mvideo.ru/>
 - <https://www.utkonos.ru/>
 - <https://www.freelancer.com/>


**PWA** – это сайт с возможностями полноценного приложения: быстрым интерфейсом, автономной работой, отправкой уведомлений, использованием камеры и сенсоров.

PWA работает в браузере десктопов и мобильных устройств без установки, и поддерживает все популярные операционные системы.

**Преимущества для пользователя:** 
- Они работают на любом устройстве. 
- Интерфейс PWA подстраивается под ширину экрана компьютера или телефона.
Разработчику достаточно создать одну программу для всех платформ.
UX сравним с приложениями для ПК и мобильного. Пользователь не ощущает разницы между использованием полноценной, установленной на устройство программы и PWA.
- Обновление в режиме реального времени благодаря Сервис Воркерам.
- Безопасность. PWA работает только по HTTPS протоколу.
- Индексируемость в поисковых движках.
- Интерактивные функции: push-уведомления и гео-локация.
- Можно закреплять иконку на домашнем экране телефона.
- Большинство функций доступны оффлайн. А если возникает необходимость дождаться ответа с сервера, PWA включает экран загрузки или отдельные элементы интерфейса, сигнализирующие о том что данные загружаются. Это направлено на улучшение пользовательского опыта.
- Ссылкой на PWA-приложение можно делиться, как на обычный вебсайт.  

**Преимущества для бизнеса:**
- Можно разработать одно решение для всех платформ: Android, iOS, Windows, MacOS и Linux.  
- Реализация маркетинговой стратегии через push-уведомления.
- PWA индексируется в поисковиках.
- Легко распространяется – достаточно поделиться ссылкой.
- По данным Google, для 50% пользователей удобнее покупать на сайтах, чем загружать приложение.


**Недостатки:**
- Не поддерживается на старых смартфонах. Для iOS – ниже версии 11.3
- Потребление энергии выше, чем у простого вебсайта.
- В отличие от мобильных приложений, PWA не представлены в магазинах AppStore и Google Play.
- Поскольку PWA не требуют верификации в магазинах приложений, гарантии безопасности для пользователей несколько ниже. С другой стороны, для разработчика отсутствие лишних согласований – это плюс.
- У PWA нет доступа к некоторым аппаратным ресурсам устройств. Например, к Bluetooth или NFC. Хотя подвижки в этом направлении есть и в ближайшем будущем можно ожидать расширение функционала прогрессивных веб-приложений.  

**Примеры:**
- <https://hca.twimg.com/ru/using-twitter/create-twitter-account>
- <https://ru.pinterest.com/>
- <https://tinder.com/ru>


**Чем PWA отличается от SPA**
SPA может относиться к прогрессивным, если соответствует трем критериям:
- надежная работа при любом состоянии сети;
- удобный и быстрый интерфейс;
- использование технологий PWA: Service Worker, HTTPS, App Shell и Web App Manifest.
При этом PWA могут быть как одностраничными, так и многостраничными.

**Зачем вообще нужны PWA? Почему нельзя ограничиться SPA или MPA?**

Экономия — создание такого приложения обходится дешевле и сокращает время разработки по сравнению с созданием отдельных нативных приложений для разных операционных систем.
PWA гарантирует хорошую производительность, высокий уровень безопасности и возможность работы онлайн или офлайн, на мобильных и десктопных устройствах, поэтому можно не беспокоиться о том, что у ваших клиентов возникнут трудности с доступом к нему.


**Какие технологии используются для реализации PWA?**  
- Service Worker
Сердце PWA — Service Worker. Это проксирующий слой между фронтэндом и бэкэндом, находящийся в браузере. Все запросы браузера идут через него. Данное разделение на два независимых слоя позволило сделать переход обычного веб сайта в PWA максимально простым.
Из хранилищ у Service Worker'a есть доступ к Cache Storage для web ресурсов, и IndexDB для данных. Но, самое главное, полная свобода для реализации бизнес логики.
Service Worker представляет собой javascript файл, подключаемый в html коде страницы. В нем разработчик определяет логику работы с приходящими из фронтэнда запросами и другую функциональность.

- HTTPS.  

PWA требует, чтобы все ресурсы сайта передавались по HTTPS протоколу. SSL сертификат можно получить бесплатно, некоторые хостеры это делают за вас. Но критично, чтобы на сайте не было ссылок на незащищенные ресурсы — некоторые браузеры просто не будут отображать сайт в этом случае.
Основная проблема в таких случаях — картинки. Часто редакторы или комментаторы ставят в материал ссылки на картинки из интернета, иногда они автоматически туда (в материал) попадают. Необходимо картинки пересохранять или к себе, или на сервис с доступом по HTTPS.

- Application Shell.  
App shell — это просто скелет графического интерфейса, шаблон. app shell хранится на клиенте и загружается при запуске приложения, а затем уже в него грузится из сети динамическая информация. И пока она грузится, app shell должен выглядеть красиво («лоадеры» на местах и т.п.)
Данную архитектуру сайта — загрузку контента и иной динамичной информации через ajax вызовы — можно продумать и реализовать на сайте заранее, тогда переход в PWA будет совсем несложным.

- Web App manifest.  
JSON файл, декларативно определяющий для браузера название приложения, иконку, как будет выглядеть PWA (fullscreen, standalone и др.) и некоторые другие параметры. Позволяет «установить» PWA как отдельное приложение на домашний экран смартфона.

- Push Notifications  
Если посерфить интернет с Chrome DevTools, открытым на вкладке Application, то можно увидеть, как мало сайтов пользуют PWA технологии. А 90% тех, что пользуют, делают это только ради Push Notifications.
Пока что это самая популярная и самая злоупотребляемая технология PWA — за последние несколько месяцев число сайтов, заходя на которые первым делом ищешь «мышкой» кнопку «Блокировать» на предложение получать самые свежие новости, выросло, такое ощущение, многократно, а само желание навязать свой Push похоже на Spam.

**Как можно понять (и можно ли), что перед нами PWA, а не другие виды приложений?** 

На данный момент, исходя из исследований и доступного в сети контента, связанного с PWA, есть такая теория: если ваше приложение обладает следующими характеристиками, то вы можете сказать, что да, мое веб-приложение является прогрессивным веб-приложением.  
* Прогрессивность: ваше веб-приложение должно работать для каждого пользователя, независимо от выбора браузера.
* Независимость от подключения: Да, именно это является одним из невоспетых героев PWA. Ваше веб-приложение должно работать независимо от интернет-соединения или некоторые функции должны работать в условиях отсутствия или медленной сети.
* Схожесть с приложением: Оно должно предоставлять пользователям опыт, подобный приложению. К таким возможностям относятся полноэкранный режим, доступ к различным встроенным аксессуарам, таким как камера, микрофон и т.д.
* Актуальность: Ваше веб-приложение всегда должно быть актуальным и не должно беспокоить пользователя просьбами об обновлении.
* Безопасность: Оно должно обслуживаться по протоколу HTTPS.
* Легкодоступность: Вы можете установить приложение или, скажем, получить доступ к нему прямо с домашнего экрана одним нажатием на кнопку «Добавить на домашний экран».
* Быстрота: Согласно отчетам, 53% пользователей покидают ваш сайт, если его загрузка занимает более 3 секунд. И очевидно, что вы не захотите, чтобы пользователи возвращались. Следовательно, ваше приложение должно быть быстрым.
* Отзывчивым: Поскольку ваше веб-приложение будет открываться в браузере, оно должно быть отзывчивым

**Чем отличается между собой тестирование SPA и MPA?**  

SPA лучше всего подходит для проектов, где SEO не играет большой роли и не нужно индексировать каждую страницу. 
Модель MPA лучше использовать для информационных ресурсов, интернет-магазинов, каталогов и маркетплейсов. Если ваша компания предоставляет большое количество товаров или услуг – нужно делать MPA.
Стоит отметить, что SPA часто является частью архитектуры многостраничного вебсайта. К примеру, основная часть ресурса может быть многостраничной, а личный кабинет реализован в виде SPA.

**Как тестировать PWA**  

При тестировании прогрессивного веб-приложения необходимо проверить следующие моменты:
- Сайт обслуживается по HTTPS: Безопасность является одной из основных проблем в прогрессивном веб-приложении, поэтому вам необходимо убедиться, что ваше веб-приложение обслуживается по HTTPS.  

Как проверить? Вы можете использовать Lighthouse от Google Developers, jitbit, seositecheckup, digicert, ssl shopper, ssl labs и т.д., чтобы проверить, обслуживается ли ваш сайт по HTTPS или нет.  
- Веб-страницы отзывчивы: Убедитесь, что ваше веб-приложение демонстрирует отзывчивое поведение на всех мобильных и настольных устройствах.  

Как проверить? Вы можете использовать функцию отзывчивости LambdaTest для проверки отзывчивости вашего веб-приложения.  

- Автономная загрузка: Все ваши веб-страницы или хотя бы некоторые из них должны работать, даже когда ваше приложение находится в автономном режиме. Вам необходимо убедиться, что ваше веб-приложение отвечает сообщением 200, когда оно находится в автономном режиме.  

Как проверить? Опять же, поскольку Google активно продвигает экосистему PWA, у них есть одни из лучших инструментов для тестирования PWA-приложений. Например, Lighthouse. Альтернативой является Wiremock.  

- Кросс-браузерная совместимость: Вам необходимо протестировать ваше веб-приложение на кросс-браузерную совместимость, чтобы убедиться, что ваше веб-приложение обеспечивает удобство работы во всех браузерах.  
Как протестировать? Вы можете использовать LambdaTest для тестирования кросс-браузерной совместимости.  

- Метаданные для ‘Add to Homescreen’: Вам необходимо проверить, предоставляет ли веб-приложение метаданные для ‘Add to Homescreen’.  

Как проверить? Вы можете использовать Lighthouse для проверки метаданных для ‘Add to Homescreen’.  
- Переходы между страницами должны быть плавными и не должны вызывать ощущения, что они блокируют сеть: Переходы являются ключевым фактором для восприятия производительности, поэтому они не должны быть плавными при перемещении, даже при медленном интернет-соединении.  

Как проверить? Это следует делать вручную в медленной сети. Когда вы нажимаете на любую кнопку или ссылку, она должна немедленно реагировать либо немедленным переходом на экран гнезда и в ожидании показывать экран загрузки, либо индикатором загрузки, пока приложение не дождется ответа.  

- Каждая страница должна иметь URL: Каждая страница вашего веб-приложения должна иметь URL, и все URL должны быть уникальными.
Как проверить? Проверьте, что на каждую страницу можно перейти по URL, и он должен быть уникальным, чтобы им можно было поделиться в социальных сетях или на других платформах. URL также можно открывать непосредственно в новых браузерах.  

- Возможность совместного использования: Контентом должно быть легко поделиться даже в полноэкранном режиме, и он должен формировать карточки для всех платформ социальных сетей.  
Как протестировать? Протестируйте вручную, поделившись контентом в полноэкранном режиме.  
- Наличие метаданных Schema.org везде, где это необходимо: Ваш веб-приложение должно уметь создавать богатые карточки, если это необходимо. Это помогает улучшить отображение вашего сайта различными поисковыми системами.  
Как проверить? Вы можете использовать структурированные данные Google, чтобы убедиться в наличии или отсутствии изображений, описаний, заголовков и т.д.  
- Push-уведомления: Если push-уведомления применимы для вашего веб-приложения, они не должны быть слишком агрессивными.
Как протестировать? Протестируйте поток отказа от push-уведомлений. Должна быть четкая инструкция, указывающая, для чего сайт хочет получить разрешение и почему пользователь должен включить push-уведомления.

